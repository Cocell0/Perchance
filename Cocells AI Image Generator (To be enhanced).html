<link rel="stylesheet" href="Perchance Default Style.css">
<!DOCTYPE html>
<link rel="preload" as="style" onload="this.onload=null;this.rel='stylesheet'" href="https://cocell0.github.io/Perchance/cocells-ai-image-generator-style.css">
<h1 style="display: none;">[$meta.title]</h1>

<div class="ebnCtn" id="chat">
  <div class="ebnBody">[comments(chatOne)]</div><button class="ebnCloseBtn" onclick="var chat = document.getElementById('chat'); chat.style.display = 'none';">❌</button>
</div>

<div class="ebnCtn" id="galleryId">
  <div class="ebnBody">[image(gallery)]</div><button class="ebnCloseBtn" onclick="var galleryId = document.getElementById('galleryId'); galleryId.style.display = 'none';">❌</button>
</div>


<div class="outputImageCtn">
  <div class="outputImageCtnAlt">
    <div id="outputImageContainerId">
      <h2 style="color: red;">Generated Images Will Appear Here</h2>
      <div style="max-width: 700px; margin: auto; text-align: justify;">
        <p>You can click the <img src="https://user-uploads.perchance.org/file/d377a607ce10b5267feaecc5971cb602.png"> button to generate images, and click on the <img src="https://user-uploads.perchance.org/file/96a318bd833a3f4b7a47f1d35942b676.png"> button for settings.</p>
        <p>You can change the theme to darkmode with <img src="https://user-uploads.perchance.org/file/1c30b7eaa12ef564039615428ed3fde1.png"> you can also access the gallery by clicking the <img src="https://user-uploads.perchance.org/file/0bbcded5e286a1a0ba160cac6bbf3e63.png"> button, and also access the chat by clicking the <img src="https://user-uploads.perchance.org/file/7c40436ee10698ce1994d86afe400aba.png"> button, all three of them are located inside the <img src="https://user-uploads.perchance.org/file/96a318bd833a3f4b7a47f1d35942b676.png"> settings.</p>
        </div>
    </div>
    <div style="background: #16191f; margin: 5px auto; max-width: 700px; width: 100%; border-radius: 1rem; overflow: hidden;"></div>
    
    <p style="display: block; margin-top: 100px; color: transparent; user-select: none;">-</p>
  </div>
  
</div>

<div>
  <div class="promptCtn">
    <div class="promptCtnAlt">
      <input type="text" placeholder="Type the prompt to generate the image" oninput="aiImagePrompt=this.value"></input>
      <button id="generateImageBtn" onclick="update()">✨</button>
      <button style="animation: attention 6s;" onclick="optionsDspFtnc()">⚙️</button>
    </div>
    <div class="OptionsCtn" id="optionsCtn" style="display: none; width: 100%;">
      <div class="promptCtnAlt secondaryCtnPrompt">
        <button onclick="darkmode()">Darkmode</button>
        <button onclick="document.getElementById('galleryId').style.display = 'flex'">Gallery</button>
        <button onclick="document.getElementById('chat').style.display = 'flex'">Chat</button>
      </div>
      <div class="OptionsCtnAlt">
        <div class="optionGrid">
          <label>Negative Prompt:</label><input style="display: flex; width: 100%;" type="text" placeholder="Type what you dont want in the image" oninput="negativePrompt=this.value"></input>
        </div>
        <div class="optionGrid">
          <label>Amounts of Images:</label><input type="number" min="1" value="8" id="imageAmounts"></input>
        </div>
        <div class="optionGrid">
          <label>Styles:</label>
          <select name="stylesEbl" id="styles">
            <option value="normal">Normal</option>
            <option value="paintedAnime">Painted Anime</option>
            <option value="softAnime">Soft Anime</option>
          </select>
        </div>
        <div class="optionGrid">
          <label>Resolution:</label>
          <select id="resolutions">
            <option value="portrait">Portrait</option>
            <option value="landscape">Landscape</option>
            <option value="square">Square</option>
          </select>
        </div>
        <div class="optionGrid">
          <label>[tooltip("Size", "Does not affect resolution")] <span id="imageSizeSpan">100</span>:</label><input style="padding: 0;" type="range" min="40" max="800" step="10" value="100" id="imageSize" oninput="imageSize=this.value"></input>
        <div>
      </div>
    </div>
  </div>
</div>









<script>
  function saveResolutionSelection() {
    var selectedResolution = document.getElementById('resolutions').value;
    localStorage.setItem('selectedResolution', selectedResolution);
  }

  function loadResolutionSelection() {
    var selectedResolution = localStorage.getItem('selectedResolution');
    if (selectedResolution) {
      document.getElementById('resolutions').value = selectedResolution;
    }
  }

  document.getElementById('resolutions').addEventListener('change', saveResolutionSelection);

  loadResolutionSelection();
</script>


<script>
  function saveSelection() {
    var selectedStyle = document.getElementById('styles').value;
    localStorage.setItem('selectedStyle', selectedStyle);
  }

  function loadSelection() {
    var selectedStyle = localStorage.getItem('selectedStyle');
    if (selectedStyle) {
      document.getElementById('styles').value = selectedStyle;
    }
  }

  document.getElementById('styles').addEventListener('change', saveSelection);

  loadSelection();
</script>

<script>
function optionsDspFtnc() {
  var optionsCtn = document.getElementById("optionsCtn");

  if (optionsCtn.style.display === "none" || optionsCtn.style.display === "") {
    optionsCtn.style.display = "block";
  } else {
    optionsCtn.style.display = "none";
  }
}
</script>
<script>
  function darkmode() {
        const body = document.body;
        body.classList.toggle('dark');
        const isDarkModeEnabled = body.classList.contains('dark');
        localStorage.setItem('darkMode', isDarkModeEnabled);
    }

    window.onload = function () {

        const savedDarkMode = localStorage.getItem('darkMode');
        const body = document.body;


        if (savedDarkMode === null) {
            const prefersDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches;

            // Apply dark mode based on browser preference
            if (prefersDarkMode) {
                body.classList.add('dark');
                localStorage.setItem('darkMode', true);
            }
        } else {
            // If dark mode is set in local storage, apply it
            if (savedDarkMode === 'true') {
                body.classList.add('dark');
            }
        }
    }; 
</script>

<script>
    const selectElement = document.getElementById('styles');

    selectElement.addEventListener('change', function() {
      
      switch (this.value) {
        case 'paintedAnime':
          prompt = '[aiImagePromptPaintedAnime]';
          break;
        case 'softAnime':
          prompt = '[aiImagePromptSoftAnime]';
          break;
      }

      update();
    });
</script>

<script>
    const resolutionSelect = document.getElementById('resolutions');

    resolutionSelect.addEventListener('change', function() {
      
      switch (this.value) {
        case 'portrait':
          promptData.resolution = '[portrait]';
          break;
        case 'landscape':
          promptData.resolution = '[landscape]';
          break;
        case 'square':
          promptData.resolution = '[square]';
          break;
      }

      update();
    });
</script>

<script> // Ai Image Script
  document.getElementById('generateImageBtn').addEventListener('click', function () {

    var newImageOutputHTML = `
      <span id="outputImage">[output]</span>
    `;
    document.getElementById('outputImageContainerId').innerHTML = '';
    
    var amount = parseInt(document.getElementById('imageAmounts').value) || 1;

    for (var i = 0; i < amount; i++) {
      document.getElementById('outputImageContainerId').innerHTML += newImageOutputHTML.evaluateItem;
    }
  });
</script>
<script>
const imageSizeInput = document.getElementById('imageSize');

const imageSizeSpan = document.getElementById('imageSizeSpan');

function updateImageSizeSpan() {
  const imageSizeValue = imageSizeInput.value;
  
  imageSizeSpan.textContent = imageSizeValue;

  localStorage.setItem('imageSize', imageSizeValue);
}
function retrieveImageSizeFromLocalStorage() {
  const storedImageSize = localStorage.getItem('imageSize');

  if (storedImageSize !== null) {
    imageSizeInput.value = storedImageSize;
    
    updateImageSizeSpan();
  }
}

imageSizeInput.addEventListener('input', updateImageSizeSpan);

retrieveImageSizeFromLocalStorage();
</script>